define("quizaccess_tcquiz/waitforquestion",["exports","core/notification","core/str"],(function(_exports,_notification,_str){var obj;
/**
   * Redirects a student to the current quiz page. Used when the student
   * joins the quiz at the start time or late.
   *
   * @module     quizaccess_tcquiz
   * @copyright  2024 Capilano University
   * @author     Tamara Dakic <tdakic@capilanou.ca>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=(obj=_notification)&&obj.__esModule?obj:{default:obj};const registerEventListeners=(sessionid,quizid,cmid,attemptid,POLLING_INTERVAL)=>{document.goToCurrentQuizPageEvent=setInterval((async()=>{await async function(sessionid,quizid,cmid,attemptid){var result=await fetch(M.cfg.wwwroot+"/mod/quiz/accessrule/tcquiz/quizdatastudent.php?quizid="+quizid+"&sessionid="+sessionid+"&cmid="+cmid+"&attempt="+attemptid+"&sesskey="+M.cfg.sesskey,{method:"POST"}),responseXMLText=await result.text();await function(responseXMLText){const responseXML=(new DOMParser).parseFromString(responseXMLText,"text/html");var quizresponse=responseXML.getElementsByTagName("tcquiz").item(0);if(null===quizresponse)return void _notification.default.addNotification({message:(0,_str.get_string)("invalidserverresponse","quizaccess_tcquiz"),type:"error"});var quizstatus=quizresponse.getElementsByTagName("status").item(0).textContent;if("showquestion"==quizstatus||"showresults"==quizstatus||"finalresults"==quizstatus){clearInterval(document.goToCurrentQuizPageEvent);var nextURL=quizresponse.getElementsByTagName("url").item(0).textContent;window.location.replace(nextURL)}else if("quiznotrunning"==quizstatus||"waitforquestion"==quizstatus||"waitforresults"==quizstatus||"noaction"==quizstatus);else if("error"==quizstatus){var errmsg=quizresponse.getElementsByTagName("message").item(0).textContent;_notification.default.addNotification({message:errmsg,type:"error"})}else _notification.default.addNotification({message:(0,_str.get_string)("unknownserverresponse","quizaccess_tcquiz")+quizstatus,type:"error"})}(responseXMLText)}(sessionid,quizid,cmid,attemptid)}),POLLING_INTERVAL)};_exports.init=(sessionid,quizid,cmid,attemptid,POLLING_INTERVAL)=>{registerEventListeners(sessionid,quizid,cmid,attemptid,POLLING_INTERVAL)}}));

//# sourceMappingURL=waitforquestion.min.js.map